import{P as b}from"./pg-event-8842ce7a.js";const t={houseContainer:null,houseMap:null,messageElement:null,lights:[],onLightsChange:s=>{},availableChars:[" ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","Ñ","O","P","Q","R","S","T","U","V","W","X","Y","Z",".",",","!","?"],setLightsValues:s=>{for(let e=0;e<s.length;e++)t.lights[e].value=s[e];t.updateMessage()},translateLightsToMessage:s=>{let e="";for(let a of s)e+=a.value;let l=parseInt(e,2);return t.availableChars[l]},updateText:s=>{const e=t.availableChars[s];t.messageElement.innerText.length>3?(t.messageElement.innerHTML=t.messageElement.innerHTML.slice(0,-1),setTimeout(()=>{t.updateText(s)},25)):t.messageElement.innerHTML+=e},updateMessage:()=>{window.scrollTo(0,1e4);let s="";for(let l of t.lights){let a=l.value;s+=a,a=="1"?(l.classList.add("prendida"),l.classList.remove("apagada")):(l.classList.remove("prendida"),l.classList.add("apagada"))}let e=parseInt(s,2);t.updateText(e)},createLights:()=>{let s=document.createElement("SELECT"),e=document.createElement("OPTION");e.innerHTML="1",e.value="1",s.appendChild(e);let l=document.createElement("OPTION");l.innerHTML="0",l.value="0",s.appendChild(l);for(let a=0;a<5;a++){let n=document.querySelector(".luz"+a),c=s.cloneNode(!0);c.value=0,c.addEventListener("change",()=>{t.onLightsChange(t.lights),t.updateMessage()}),n.appendChild(c),t.lights===void 0&&(t.lights=[]),t.lights.push(c)}},createHouse:(s,e)=>{for(let l of e){let a=document.createElement("TR");for(let n of l)if(n!="n"){let c=document.createElement("TD");c.classList.add(n),n.includes("luz")&&(c.setAttribute("colspan","2"),c.setAttribute("rowspan","2")),n.includes("mensaje")&&(c.setAttribute("colspan","4"),c.setAttribute("rowspan","3"),c.setAttribute("id","caja-mensajes")),a.appendChild(c)}s.appendChild(a)}},init:(s,e,l,a)=>{t.houseContainer=s,t.houseMap=e,t.messageElement=l,t.onLightsChange=a,t.createHouse(s,e),t.createLights()}};class f{constructor(e,l){this.duration=e,this.callback=l,this.timer=null}start(){this.stop(),this.timer=setTimeout(()=>{this.callback(),this.start()},this.duration)}stop(){this.timer&&(clearTimeout(this.timer),this.timer=null)}reset(){this.stop(),this.start()}}const T=s=>{let e=!1,l=!1;const a=(r,o)=>r.translateLightsToMessage(o)===s,n=(r,o)=>{if(!e){console.log("No hay cambios pendientes.");return}const v=a(r,o),m=v?"¡Felicidades! Has encontrado la letra correcta.":"¡Oh no! Esa no es la letra correcta. Inténtalo de nuevo.";c.postToPg({event:v?"SUCCESS":"FAILURE",message:m,reasons:[],state:JSON.stringify({lights:Array.from(o).map(g=>parseInt(g.value))})}),e=!1,l=v},c=new b,p=document.getElementById("casa"),h=[["c","c","c","c","c","c","c","c","c","c","c","c","c","c","c","c","c","c","c","c","c","c"],["c","c","c","c","c","c","c","c","ti","t","t","t","t","td","c","c","c","c","c","c","c","c"],["c","c","c","c","c","c","c","ti","t","t","t","t","t","t","td","c","c","c","c","c","c","c"],["c","c","c","c","c","c","ti","t","t","mensaje","n","n","n","t","t","td","c","c","c","c","c","c"],["c","c","c","c","c","ti","t","t","t","n","n","n","n","t","t","t","td","c","c","c","c","c"],["c","c","c","c","ti","t","t","t","t","n","n","n","n","t","t","t","t","td","c","c","c","c"],["c","c","c","ti","t","t","t","t","t","t","t","t","t","t","t","t","t","t","td","c","c","c"],["c","c","ti","t","t","t","t","t","t","t","t","t","t","t","t","t","t","t","t","td","c","c"],["c","tiab","p","bl","bl","bl","bl","bl","bl","bl","bl","bl","bl","bl","bl","bl","bl","bl","bl","p","tdab","c"],["c","c","p","bl","luz0","n","bl","luz1","n","bl","luz2","n","bl","luz3","n","bl","luz4","n","bl","p","c","c"],["c","c","p","bl","n","n","bl","n","n","bl","n","n","bl","n","n","bl","n","n","bl","p","c","c"],["v","v","p","bl","bl","bl","bl","bl","bl","bl","bl","bl","bl","bl","bl","bl","bl","bl","bl","p","v","v"],["v","v","p","p","p","p","p","p","p","p","p","p","p","p","p","p","p","p","p","p","v","v"],["v","v","v","v","v","v","v","v","v","v","v","v","v","v","v","v","v","v","v","v","v","v"],["v","v","v","v","v","v","v","v","v","v","v","v","v","v","v","v","v","v","v","v","v","v"]],d=document.getElementById("mensaje"),i=Object.create(t),u=new f(8e3,()=>n(i,i.lights));u.start(),i.init(p,h,d,r=>{e=!0,u.reset(),a(i,r)!==l&&n(i,r)}),c.getValues(),c.data.lights&&i.setLightsValues(c.data.lights)};export{T as C};

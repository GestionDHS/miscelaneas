import"./modulepreload-polyfill-ec808ebb.js";class d{constructor(){this.data={type:"house-type",event:0,message:"",id:"",state:""}}getValues(){const l=document.location.href.split("?");if(l.length<2)return;const a=l[1].split("&");for(const n of a){if(n.length<2)continue;const c=n.split("=");if(!(c.length<2))switch(c[0]){case ID:this.data[ID]=c[1];break}}}onSuccessEvent(t){this.data.event="SUCCESS",this.data.message=t,window.top.postMessage(this.data,"*")}onFailEvent(t){this.data.event="FAILURE",this.data.message=t,window.top.postMessage(this.data,"*")}sendState(t){this.data.event="STATE",this.data.state=t,window.top.postMessage(this.data,"*")}}const e={houseContainer:null,houseMap:null,messageElement:null,lights:[],onLightsChange:s=>{},availableChars:[" ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","Ñ","O","P","Q","R","S","T","U","V","W","X","Y","Z",".",",","!","?"],setLightsValues:s=>{for(let t=0;t<s.length;t++)e.lights[t].value=s[t];e.updateMessage()},translateLightsToMessage:s=>{let t="";for(let a of s)t+=a.value;let l=parseInt(t,2);return e.availableChars[l]},updateText:s=>{const t=e.availableChars[s];e.messageElement.innerText.length>3?(e.messageElement.innerHTML=e.messageElement.innerHTML.slice(0,-1),setTimeout(()=>{e.updateText(s)},25)):e.messageElement.innerHTML+=t},updateMessage:()=>{window.scrollTo(0,1e4);let s="";for(let l of e.lights){let a=l.value;s+=a,a=="1"?(l.classList.add("prendida"),l.classList.remove("apagada")):(l.classList.remove("prendida"),l.classList.add("apagada"))}let t=parseInt(s,2);e.updateText(t)},createLights:()=>{let s=document.createElement("SELECT"),t=document.createElement("OPTION");t.innerHTML="1",t.value="1",s.appendChild(t);let l=document.createElement("OPTION");l.innerHTML="0",l.value="0",s.appendChild(l);for(let a=0;a<5;a++){let n=document.querySelector(".luz"+a),c=s.cloneNode(!0);c.value=0,c.addEventListener("change",()=>{e.onLightsChange(e.lights),e.updateMessage()}),n.appendChild(c),e.lights===void 0&&(e.lights=[]),e.lights.push(c)}},createHouse:(s,t)=>{for(let l of t){let a=document.createElement("TR");for(let n of l)if(n!="n"){let c=document.createElement("TD");c.classList.add(n),n.includes("luz")&&(c.setAttribute("colspan","2"),c.setAttribute("rowspan","2")),n.includes("mensaje")&&(c.setAttribute("colspan","4"),c.setAttribute("rowspan","3"),c.setAttribute("id","caja-mensajes")),a.appendChild(c)}s.appendChild(a)}},init:(s,t,l,a)=>{e.houseContainer=s,e.houseMap=t,e.messageElement=l,e.onLightsChange=a,e.createHouse(s,t),e.createLights()}},v=s=>{const t=new d,l=document.getElementById("casa"),a=[["c","c","c","c","c","c","c","c","c","c","c","c","c","c","c","c","c","c","c","c","c","c"],["c","c","c","c","c","c","c","c","ti","t","t","t","t","td","c","c","c","c","c","c","c","c"],["c","c","c","c","c","c","c","ti","t","t","t","t","t","t","td","c","c","c","c","c","c","c"],["c","c","c","c","c","c","ti","t","t","mensaje","n","n","n","t","t","td","c","c","c","c","c","c"],["c","c","c","c","c","ti","t","t","t","n","n","n","n","t","t","t","td","c","c","c","c","c"],["c","c","c","c","ti","t","t","t","t","n","n","n","n","t","t","t","t","td","c","c","c","c"],["c","c","c","ti","t","t","t","t","t","t","t","t","t","t","t","t","t","t","td","c","c","c"],["c","c","ti","t","t","t","t","t","t","t","t","t","t","t","t","t","t","t","t","td","c","c"],["c","tiab","p","bl","bl","bl","bl","bl","bl","bl","bl","bl","bl","bl","bl","bl","bl","bl","bl","p","tdab","c"],["c","c","p","bl","luz0","n","bl","luz1","n","bl","luz2","n","bl","luz3","n","bl","luz4","n","bl","p","c","c"],["c","c","p","bl","n","n","bl","n","n","bl","n","n","bl","n","n","bl","n","n","bl","p","c","c"],["v","v","p","bl","bl","bl","bl","bl","bl","bl","bl","bl","bl","bl","bl","bl","bl","bl","bl","p","v","v"],["v","v","p","p","p","p","p","p","p","p","p","p","p","p","p","p","p","p","p","p","v","v"],["v","v","v","v","v","v","v","v","v","v","v","v","v","v","v","v","v","v","v","v","v","v"],["v","v","v","v","v","v","v","v","v","v","v","v","v","v","v","v","v","v","v","v","v","v"]],n=document.getElementById("mensaje"),c=Object.create(e);if(c.init(l,a,n,i=>{if(c.translateLightsToMessage(i)!==s){t.onFailEvent("¡Oh no! Esa no es la letra correcta. Inténtalo de nuevo.");return}t.onSuccessEvent("¡Bien hecho! Has encontrado la letra correcta.");const o=[];for(let r of i)o.push(parseInt(r.value));t.sendState(o)}),t.getValues(),t.data.state){const i=t.data.state.split(",");c.setLightsValues(i)}};window.onload=()=>{v("J")};

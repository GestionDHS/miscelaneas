import"./modulepreload-polyfill-ec808ebb.js";class r{constructor(){this.data={type:"house-type",event:0,message:"",id:"",state:""}}getValues(){const a=document.location.href.split("?");if(a.length<2)return;const c=a[1].split("&");for(const n of c){if(n.length<2)continue;const l=n.split("=");if(!(l.length<2)){console.log("Received data: ",l);for(const i in this.data)i===l[0]&&(this.data[i]=l[1])}}}onSuccessEvent(t){this.data.event="SUCCESS",this.data.message=t,window.top.postMessage(this.data,"*")}onFailEvent(t){this.data.event="FAILURE",this.data.message=t,window.top.postMessage(this.data,"*")}sendState(t){this.data.event="STATE",this.data.state=t,window.top.postMessage(this.data,"*")}}const e={houseContainer:null,houseMap:null,messageElement:null,lights:[],onLightsChange:s=>{},availableChars:[" ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","Ñ","O","P","Q","R","S","T","U","V","W","X","Y","Z",".",",","!","?"],setLightsValues:s=>{for(let t=0;t<s.length;t++)e.lights[t].value=s[t];e.updateMessage()},translateLightsToMessage:s=>{let t="";for(let c of s)t+=c.value;let a=parseInt(t,2);return e.availableChars[a]},updateText:s=>{const t=e.availableChars[s];e.messageElement.innerText.length>3?(e.messageElement.innerHTML=e.messageElement.innerHTML.slice(0,-1),setTimeout(()=>{e.updateText(s)},25)):e.messageElement.innerHTML+=t},updateMessage:()=>{window.scrollTo(0,1e4);let s="";for(let a of e.lights){let c=a.value;s+=c,c=="1"?(a.classList.add("prendida"),a.classList.remove("apagada")):(a.classList.remove("prendida"),a.classList.add("apagada"))}let t=parseInt(s,2);e.updateText(t)},createLights:()=>{let s=document.createElement("SELECT"),t=document.createElement("OPTION");t.innerHTML="1",t.value="1",s.appendChild(t);let a=document.createElement("OPTION");a.innerHTML="0",a.value="0",s.appendChild(a);for(let c=0;c<5;c++){let n=document.querySelector(".luz"+c),l=s.cloneNode(!0);l.value=0,l.addEventListener("change",()=>{e.onLightsChange(e.lights),e.updateMessage()}),n.appendChild(l),e.lights===void 0&&(e.lights=[]),e.lights.push(l)}},createHouse:(s,t)=>{for(let a of t){let c=document.createElement("TR");for(let n of a)if(n!="n"){let l=document.createElement("TD");l.classList.add(n),n.includes("luz")&&(l.setAttribute("colspan","2"),l.setAttribute("rowspan","2")),n.includes("mensaje")&&(l.setAttribute("colspan","4"),l.setAttribute("rowspan","3"),l.setAttribute("id","caja-mensajes")),c.appendChild(l)}s.appendChild(c)}},init:(s,t,a,c)=>{e.houseContainer=s,e.houseMap=t,e.messageElement=a,e.onLightsChange=c,e.createHouse(s,t),e.createLights()}},v=s=>{const t=new r,a=document.getElementById("casa"),c=[["c","c","c","c","c","c","c","c","c","c","c","c","c","c","c","c","c","c","c","c","c","c"],["c","c","c","c","c","c","c","c","ti","t","t","t","t","td","c","c","c","c","c","c","c","c"],["c","c","c","c","c","c","c","ti","t","t","t","t","t","t","td","c","c","c","c","c","c","c"],["c","c","c","c","c","c","ti","t","t","mensaje","n","n","n","t","t","td","c","c","c","c","c","c"],["c","c","c","c","c","ti","t","t","t","n","n","n","n","t","t","t","td","c","c","c","c","c"],["c","c","c","c","ti","t","t","t","t","n","n","n","n","t","t","t","t","td","c","c","c","c"],["c","c","c","ti","t","t","t","t","t","t","t","t","t","t","t","t","t","t","td","c","c","c"],["c","c","ti","t","t","t","t","t","t","t","t","t","t","t","t","t","t","t","t","td","c","c"],["c","tiab","p","bl","bl","bl","bl","bl","bl","bl","bl","bl","bl","bl","bl","bl","bl","bl","bl","p","tdab","c"],["c","c","p","bl","luz0","n","bl","luz1","n","bl","luz2","n","bl","luz3","n","bl","luz4","n","bl","p","c","c"],["c","c","p","bl","n","n","bl","n","n","bl","n","n","bl","n","n","bl","n","n","bl","p","c","c"],["v","v","p","bl","bl","bl","bl","bl","bl","bl","bl","bl","bl","bl","bl","bl","bl","bl","bl","p","v","v"],["v","v","p","p","p","p","p","p","p","p","p","p","p","p","p","p","p","p","p","p","v","v"],["v","v","v","v","v","v","v","v","v","v","v","v","v","v","v","v","v","v","v","v","v","v"],["v","v","v","v","v","v","v","v","v","v","v","v","v","v","v","v","v","v","v","v","v","v"]],n=document.getElementById("mensaje"),l=Object.create(e);if(l.init(a,c,n,i=>{if(l.translateLightsToMessage(i)!==s){t.onFailEvent("¡Oh no! Esa no es la letra correcta. Inténtalo de nuevo.");return}t.onSuccessEvent("¡Bien hecho! Has encontrado la letra correcta.");const o=[];for(let d of i)o.push(parseInt(d.value));t.sendState(o)}),t.getValues(),t.data.state){const i=t.data.state.split(",");l.setLightsValues(i)}};window.onload=()=>{v("J")};

import"./modulepreload-polyfill-ec808ebb.js";const r="id";class p{constructor(){this.data={type:"blockly-type",id:""}}getValues(){const s=document.location.href.split("?");if(s.length<2)return;const n=s[1].split("&");for(const a of n){if(a.length<2)continue;const c=a.split("=");if(!(c.length<2))switch(c[0]){case r:this.data[r]=c[1];break}}}postToPg(t){t.type=this.data.type,t.id=this.data.id,window.top.postMessage(t,"*")}}const e={houseContainer:null,houseMap:null,messageElement:null,lights:[],onLightsChange:l=>{},availableChars:[" ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","Ñ","O","P","Q","R","S","T","U","V","W","X","Y","Z",".",",","!","?"],setLightsValues:l=>{for(let t=0;t<l.length;t++)e.lights[t].value=l[t];e.updateMessage()},translateLightsToMessage:l=>{let t="";for(let n of l)t+=n.value;let s=parseInt(t,2);return e.availableChars[s]},updateText:l=>{const t=e.availableChars[l];e.messageElement.innerText.length>3?(e.messageElement.innerHTML=e.messageElement.innerHTML.slice(0,-1),setTimeout(()=>{e.updateText(l)},25)):e.messageElement.innerHTML+=t},updateMessage:()=>{window.scrollTo(0,1e4);let l="";for(let s of e.lights){let n=s.value;l+=n,n=="1"?(s.classList.add("prendida"),s.classList.remove("apagada")):(s.classList.remove("prendida"),s.classList.add("apagada"))}let t=parseInt(l,2);e.updateText(t)},createLights:()=>{let l=document.createElement("SELECT"),t=document.createElement("OPTION");t.innerHTML="1",t.value="1",l.appendChild(t);let s=document.createElement("OPTION");s.innerHTML="0",s.value="0",l.appendChild(s);for(let n=0;n<5;n++){let a=document.querySelector(".luz"+n),c=l.cloneNode(!0);c.value=0,c.addEventListener("change",()=>{e.onLightsChange(e.lights),e.updateMessage()}),a.appendChild(c),e.lights===void 0&&(e.lights=[]),e.lights.push(c)}},createHouse:(l,t)=>{for(let s of t){let n=document.createElement("TR");for(let a of s)if(a!="n"){let c=document.createElement("TD");c.classList.add(a),a.includes("luz")&&(c.setAttribute("colspan","2"),c.setAttribute("rowspan","2")),a.includes("mensaje")&&(c.setAttribute("colspan","4"),c.setAttribute("rowspan","3"),c.setAttribute("id","caja-mensajes")),n.appendChild(c)}l.appendChild(n)}},init:(l,t,s,n)=>{e.houseContainer=l,e.houseMap=t,e.messageElement=s,e.onLightsChange=n,e.createHouse(l,t),e.createLights()}},v=l=>{const t=new p,s=document.getElementById("casa"),n=[["c","c","c","c","c","c","c","c","c","c","c","c","c","c","c","c","c","c","c","c","c","c"],["c","c","c","c","c","c","c","c","ti","t","t","t","t","td","c","c","c","c","c","c","c","c"],["c","c","c","c","c","c","c","ti","t","t","t","t","t","t","td","c","c","c","c","c","c","c"],["c","c","c","c","c","c","ti","t","t","mensaje","n","n","n","t","t","td","c","c","c","c","c","c"],["c","c","c","c","c","ti","t","t","t","n","n","n","n","t","t","t","td","c","c","c","c","c"],["c","c","c","c","ti","t","t","t","t","n","n","n","n","t","t","t","t","td","c","c","c","c"],["c","c","c","ti","t","t","t","t","t","t","t","t","t","t","t","t","t","t","td","c","c","c"],["c","c","ti","t","t","t","t","t","t","t","t","t","t","t","t","t","t","t","t","td","c","c"],["c","tiab","p","bl","bl","bl","bl","bl","bl","bl","bl","bl","bl","bl","bl","bl","bl","bl","bl","p","tdab","c"],["c","c","p","bl","luz0","n","bl","luz1","n","bl","luz2","n","bl","luz3","n","bl","luz4","n","bl","p","c","c"],["c","c","p","bl","n","n","bl","n","n","bl","n","n","bl","n","n","bl","n","n","bl","p","c","c"],["v","v","p","bl","bl","bl","bl","bl","bl","bl","bl","bl","bl","bl","bl","bl","bl","bl","bl","p","v","v"],["v","v","p","p","p","p","p","p","p","p","p","p","p","p","p","p","p","p","p","p","v","v"],["v","v","v","v","v","v","v","v","v","v","v","v","v","v","v","v","v","v","v","v","v","v"],["v","v","v","v","v","v","v","v","v","v","v","v","v","v","v","v","v","v","v","v","v","v"]],a=document.getElementById("mensaje"),c=Object.create(e);c.init(s,n,a,i=>{if(c.translateLightsToMessage(i)!==l){t.postToPg({event:"FAILURE",message:"¡Oh no! Esa no es la letra correcta. Inténtalo de nuevo.",reasons:[],state:JSON.stringify({lights:Array.from(i).map(o=>parseInt(o.value))})});return}t.postToPg({event:"SUCCESS",message:"¡Felicidades! Has encontrado la letra correcta.",reasons:[],state:JSON.stringify({lights:Array.from(i).map(o=>parseInt(o.value))})})}),t.getValues(),t.data.lights&&c.setLightsValues(t.data.lights)};window.onload=()=>{v("J")};
